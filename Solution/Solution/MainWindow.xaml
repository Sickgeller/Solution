<Window x:Class="Solution.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:domain="clr-namespace:Solution.Domain.Entities;assembly=Solution.Domain"
        Title="MES Lite - WorkOrders" Height="520" Width="920" WindowStartupLocation="CenterScreen">
  <Window.Resources>
    <ObjectDataProvider x:Key="WorkOrderStatuses" MethodName="GetValues" ObjectType="{x:Type sys:Enum}">
      <ObjectDataProvider.MethodParameters>
        <x:Type TypeName="domain:WorkOrderStatus"/>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>
  </Window.Resources>

  <Grid Margin="12">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="3*"/>
      <ColumnDefinition Width="2*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <StackPanel Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,0,0,8">
      <TextBox Width="160" Margin="0,0,8,0" Text="{Binding ItemCodeFilter, UpdateSourceTrigger=PropertyChanged}"/>
      <ComboBox Width="120" Margin="0,0,8,0" ItemsSource="{Binding Source={StaticResource WorkOrderStatuses}}" SelectedItem="{Binding StatusFilter}"/>
      <DatePicker Width="140" Margin="0,0,8,0" SelectedDate="{Binding DueFrom}"/>
      <DatePicker Width="140" Margin="0,0,8,0" SelectedDate="{Binding DueTo}"/>
      <ComboBox Width="80" Margin="0,0,8,0" SelectedValuePath="Content" SelectedValue="{Binding PageSize}">
        <ComboBoxItem Content="50"/>
        <ComboBoxItem Content="100"/>
        <ComboBoxItem Content="200"/>
      </ComboBox>
      <Button Content="불러오기" Width="90" Margin="0,0,8,0" Command="{Binding LoadPageCommand}"/>
      <Button Content="◀" Width="40" Margin="0,0,4,0" Command="{Binding LoadPageCommand}" CommandParameter="Prev"/>
      <Button Content="▶" Width="40" Margin="0,0,8,0" Command="{Binding LoadPageCommand}" CommandParameter="Next"/>
      <TextBlock VerticalAlignment="Center" Text="{Binding Page, StringFormat=페이지 {0}}"/>

      <Button Content="신규" Width="70" Margin="8,0,8,0" Command="{Binding NewCommand}"/>
      <Button Content="선택 편집" Width="100" Margin="0,0,8,0" Command="{Binding EditCommand}"/>
      <Button Content="삭제" Width="70" Margin="0,0,8,0" Command="{Binding DeleteCommand}"/>
    </StackPanel>

    <DataGrid Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
              ItemsSource="{Binding Items}" SelectedItem="{Binding Selected}"
              Margin="0,0,8,0">
      <DataGrid.Columns>
        <DataGridTextColumn Header="품목코드" Binding="{Binding ItemCode}" Width="*"/>
        <DataGridTextColumn Header="수량" Binding="{Binding Quantity}" Width="100"/>
        <DataGridTextColumn Header="납기" Binding="{Binding DueDate, StringFormat=\{0:yyyy-MM-dd\}}" Width="140"/>
        <DataGridTextColumn Header="상태" Binding="{Binding Status}" Width="140"/>
      </DataGrid.Columns>
    </DataGrid>

    <GroupBox Grid.Column="1" Grid.Row="1" Header="편집">
      <StackPanel Margin="10">
        <TextBlock Text="품목코드"/>
        <TextBox Text="{Binding EditModel.ItemCode, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,8"/>

        <TextBlock Text="수량"/>
        <TextBox Text="{Binding EditModel.Quantity, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,8"/>

        <TextBlock Text="납기"/>
        <DatePicker SelectedDate="{Binding EditModel.DueDate}" Margin="0,0,0,8"/>

        <TextBlock Text="상태"/>
        <ComboBox ItemsSource="{Binding Source={StaticResource WorkOrderStatuses}}"
                  SelectedItem="{Binding EditModel.Status}" Margin="0,0,0,12"/>

        <Button Content="저장" Width="100" Command="{Binding SaveCommand}"/>
      </StackPanel>
    </GroupBox>

    <TextBlock Grid.Row="2" Grid.ColumnSpan="2" Text="WPF + MVVM + SQL Server • WorkOrders"
               Foreground="Gray" HorizontalAlignment="Right"/>
  </Grid>
</Window>